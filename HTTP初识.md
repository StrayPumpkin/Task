# HTTP初识

## 作用

**定义通信规则**：HTTP协议规定了浏览器和服务器之间如何交流。

**定义请求和响应格式**：HTTP协议不仅规定了通信的规则，还规定了请求和响应的格式。

**处理请求和响应**：HTTP协议还定义了一些处理请求和响应的规则

## 基本工作原理

1.**客户端发起请求**：
当用户在浏览器中输入URL或点击某个链接时，浏览器会作为HTTP客户端，根据URL信息构建HTTP请求。

2.**建立连接**：
客户端通过TCP/IP协议与服务器建立连接。

3.**服务器处理请求**：
服务器接收到客户端的请求后，会根据请求中的URL定位到相应的资源或处理逻辑。

4.**生成响应**：
根据请求的处理结果，服务器会生成HTTP响应

5.**发送响应并关闭连接**：
服务器将生成的响应发送回客户端，并通过TCP/IP连接将数据传输给客户端

6.**客户端处理响应**：
客户端接收到服务器的响应后，会根据响应中的状态码和内容执行相应的处理。

## HTTP请求

1. **请求行**：包含请求方法（如GET, POST, PUT, DELETE等）、请求资源的URI以及HTTP版本号。
2. **请求头**：包含一系列键值对，提供有关请求的附加信息。常见的请求头包括`User-Agent`（客户端类型）、`Accept`（可接受的数据类型）等。
3. **请求体**：不是所有请求都包含请求体。当使用GET或HEAD方法时，请求体通常为空。而对于POST、PUT等方法，请求体会包含要发送给服务器的实际数据。请求体的数据类型由`Content-Type`头指定。

## HTTP响应

1. **状态行**：包含HTTP版本号、状态码以及简短的原因短语。
2. **响应头**：与请求头类似，响应头也包含一系列键值对，提供有关响应的附加信息。常见的响应头包括`Content-Type`（响应数据的类型）、`Content-Length`（响应体的长度）等。
3. **响应体**：包含服务器返回的实际数据。对于HTML页面、图片等资源，响应体将包含这些资源的实际内容。响应体的数据类型由`Content-Type`头指定。

## 请求与响应的交互流程

1. 客户端（通常是浏览器）根据用户操作（如点击链接、提交表单等）构造HTTP请求。

2. 客户端通过网络将HTTP请求发送给服务器。
3. 服务器接收到HTTP请求后，根据请求内容进行处理。
4. 服务器构造HTTP响应，并将其发送回客户端。
5. 客户端接收到HTTP响应后，根据响应内容进行相应处理（如显示网页、执行操作等）。

## HTTP方法

**GET**：这是最常用的方法，用于请求指定的页面信息。当使用GET方法时，浏览器会向服务器发送请求，并获取服务器返回的资源。GET请求的数据会附加在URL之后，并以查询字符串的形式呈现。

```
http
GET /users/123 HTTP/1.1 // 请求行，指定方法为GET，请求的资源路径为/users/123，使用的HTTP协议版本为1.1
Host: example.com // 请求头，指定请求的主机名
Accept: text/html // 请求头，表示客户端希望接收的响应内容类型
User-Agent: Mozilla/5.0 // 请求头，包含客户端（浏览器）的类型和版本信息
// GET请求没有请求体，所有需要传输的数据都包含在URL中
```



**HEAD**：类似于GET请求，但返回的响应中没有具体的内容，只包含报头。这种方法通常用于获取与特定资源关联的元信息，而不需要传输整个资源本身。

```
http
HEAD /favicon.ico HTTP/1.1 // 请求行，指定方法为HEAD，请求的资源路径为/favicon.ico，使用的HTTP协议版本为1.1
Host: example.com // 请求头，指定请求的主机名
Accept: / // 请求头，表示客户端希望接收任何类型的响应内容
// HEAD请求没有请求体，服务器只返回响应头，不包含响应体
```



**POST**：用于向指定资源提交数据进行处理请求（例如提交表单或者上传文件）。与GET方法不同，POST请求的数据包含在请求体中，这样可以在请求中发送大量数据，而且这些数据不会在URL中显示。POST请求可能会导致新的资源的建立或已有资源的修改。

```
http
POST /login HTTP/1.1 // 请求行，指定方法为POST，请求的资源路径为/login，使用的HTTP协议版本为1.1
Host: example.com // 请求头，指定请求的主机名
Content-Type: application/x-www-form-urlencoded // 请求头，指定请求体的内容类型
Content-Length: 34 // 请求头，指定请求体的长度
username=myuser&password=mypass // 请求体，包含要提交给服务器的表单数据
```

## HTTP状态码

1. **1xx（临时响应）**：信息性状态码，表明请求已被接受，正在处理中。

   示例：100 Continue，101 Switching Protocols

2. **2xx（成功**）：表示请求已成功被服务器接收、理解并接受。

   示例：200 OK，201 Created，202 Accepted，204 No Content

3. **3xx（重定向）**：要求客户端采取进一步操作完成请求。

   示例：301 Moved Permanently（永久重定向），302 Found（临时重定向），304 Not Modified（资源未修改）

4. **4xx（客户端错误**）：由于客户端错误（如请求语法错误或无效请求）导致请求无法满足。

   示例：400 Bad Request（错误请求），401 Unauthorized（未授权），403 Forbidden（禁止访问），404 Not Found（找不到资源）

5. **5xx（服务器错误）**：服务器在处理请求时遇到了意外情况，未能完成请求。

   示例：500 Internal Server Error（内部服务器错误），502 Bad Gateway（错误的网关），503 Service Unavailable（服务不可用），504 Gateway Timeout（网关超时）

## 一个完整的http请求响应的过程

1. **DNS解析**

​	浏览器将域名（如`www.example.com`）解析为IP地址。

2. **建立TCP连接**

​	浏览器与服务器通过TCP三次握手建立连接。

3. **发送HTTP请求**

​	浏览器发送HTTP请求报文。

4. **服务器处理请求**

​	服务器解析请求并生成响应。

5. **服务器发送HTTP响应**

​	服务器发送HTTP响应报文。

6. **浏览器接收并渲染响应**

​	浏览器接收响应并渲染页面。

7. **关闭TCP连接**

​	通过四次挥手关闭连接。

